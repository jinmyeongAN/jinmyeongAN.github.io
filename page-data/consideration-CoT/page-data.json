{"componentChunkName":"component---src-templates-blog-template-js","path":"/consideration-CoT/","result":{"data":{"cur":{"id":"635f55ef-32c1-5417-9eea-9ab7cd12d5ee","html":"<blockquote>\n<p><strong>AI should be able to learn from just a few examples, like what humans usually do</strong></p>\n<p>- <em>Denny Zhou</em> -</p>\n</blockquote>\n<h2 id=\"-의외로-잘-모르는-cot\" style=\"position:relative;\"><a href=\"#-%EC%9D%98%EC%99%B8%EB%A1%9C-%EC%9E%98-%EB%AA%A8%EB%A5%B4%EB%8A%94-cot\" aria-label=\" 의외로 잘 모르는 cot permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🤔 의외로 잘 모르는 CoT</h2>\n<p>NLP 연구를 하면서 Chain-of-Thought (CoT) [1] 를 듣지 않기란 쉽지 않다.</p>\n<p>그러나, 생각해보니 얕은 깊이의 개념 정도만 인지하고 있을뿐 CoT에 대해 깊이 생각해본적이 없고,</p>\n<p>심지어 CoT 논문도 제대로 읽어본적도 없다…!!</p>\n<p>이번 기회에 CoT 뿐만 아니라, 이후 후속연구도 보면서 CoT가 가지고 있는 <strong>insight</strong>을 파헤쳐 보려한다.</p>\n<p>이번 글은 특히 <a href=\"https://dennyzhou.github.io/LLM-Reasoning-Berkeley.pdf\">“LLM Reasoning: Key Ideas and Limitations”</a> [2] 글에 큰 영향을 받았다.</p>\n<h2 id=\"-prompt-기반-intermediate-steps-rationale\" style=\"position:relative;\"><a href=\"#-prompt-%EA%B8%B0%EB%B0%98-intermediate-steps-rationale\" aria-label=\" prompt 기반 intermediate steps rationale permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>📌 Prompt 기반 Intermediate steps (rationale)</h2>\n<p>CoT 논문을 보다보면 Intermediate steps이라는 용어가 자주 등장한다.</p>\n<p>Intermediate steps이란 정답을 내기까지의 중간 과정을 의미한다.</p>\n<p>CoT 논문에서는 이러한 Intermediate steps을 가지는 few-shots example를 prompt로 넣어줬을 때 (Problem + Intermediate steps + Answer), LLM은 reasoning을 필요로하는 task에서 중간과정을 포함해 보다 정확한 답을 낼 수 있다는 가정을 하고 있다.</p>\n<p>그리고 실제로 CoT 기반의 프롬프트로 이전보다 월등히 높은 성능을 기록했다.[1]</p>\n<p>사실 CoT가 rationale이 answer에 도움을 준다는 것을 처음으로 발견한 연구는 아니다. 이전에도 비슷한 연구 [3] 는 있었지만, 이 경우 언어모델을 tuning 함으로써 rationale을 내뱉게 했다.</p>\n<p>여기서 한가지 궁금한 점이 생겼다.</p>\n<blockquote>\n<p>few-shots example 만으로 tuning 기반의 성능 또는 그 이상의 결과를 만들어냈다는 것은 무슨 의미일까?</p>\n</blockquote>\n<p>수많은 데이터를 기반으로 input과 output간의 패턴을 tuning을 통해 파악하는게 아니라, a few example만으로 패턴을 파악한다는 사실은 놀라운 일이다.</p>\n<p>LLM이 prompt 만으로 문제 해결 방법을 여러개로 쪼갤 수 있고, 쪼개진 작은 문제는 LLM 정도면 쉽게 해결할 수 있기 때문일까?</p>\n<p>Denny zhou에 따르면 [2] LLM이 인간처럼 reasoning 할 수 있게 되었다고 설명한다. (인간이 reasoning 능력을 이용해 few example만으로 학습이 가능한 것처럼)</p>\n<p>그러나 여전히 명확하지 않다.</p>\n<p>CoT를 통해 answer와 함께 intermediate step을 출력하는 행위는 왜 LLM의 성능을 올려주는 것일까?</p>\n<h2 id=\"-intermediate-stepcot이-llm에-미치는-영향\" style=\"position:relative;\"><a href=\"#-intermediate-stepcot%EC%9D%B4-llm%EC%97%90-%EB%AF%B8%EC%B9%98%EB%8A%94-%EC%98%81%ED%96%A5\" aria-label=\" intermediate stepcot이 llm에 미치는 영향 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>📌 Intermediate step(CoT)이 LLM에 미치는 영향</h2>\n<p>역시 이에 대한 연구도 존재한다. [4]</p>\n<p>이 연구는 CoT가 answer에 도움을 주는 이유를 CoT는 transformer가 serial computation을 할 수 있도록 돕고 expressiveness를 높이기 때문이라는 가정을 세웠다.</p>\n<p>이 가정은 기본적으로 transformer는 문제를 parallel하게 푼다는 사실을 기반으로 하고 있다.</p>\n<p>다시 말해, decoder-only transformer는 self-attention을 기반으로 하는데, 이는 모든 input을 순서대로가 아니라 한번에 보는 것을 의미한다.</p>\n<p>이 경우 하나의 problem을 one step에 풀어버리는데, 간단한 문제의 경우 쉽게 풀 수 있지만, sequential reasoning이 필요한 경우 필수적인 intermediate step가 생략될 수 있다.</p>\n<p>또한 transformer의 layer 수가 input과 상관없이 contant하다는 것도 이유이다. (제한된 expressiveness)</p>\n<p>이 때, CoT는 마치 extra layer 처럼 역할을 하여 더 정확한 예측을 하게한다.</p>\n<p>실험을 통해 이 2가지 가정을 증명하려 노력했는데, 굉장히 인상적이었다.</p>\n<p>그러나 여전히 의문이 든다.</p>\n<p>LLM은 결국 few-shots에 있는 intermediate step을 모방한 것이라는 생각이 든다.</p>\n<blockquote>\n<p>그렇다면 과연 few-shots과 다른 종류의 problem을 만났을 때 robust한 reasoning 및 정확한 답을 할 수 있을까?</p>\n</blockquote>\n<h2 id=\"-cot의-robustness\" style=\"position:relative;\"><a href=\"#-cot%EC%9D%98-robustness\" aria-label=\" cot의 robustness permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>📌 CoT의 robustness</h2>\n<p>역시 이에 대한 생각을 가진 연구가 있었다. [5]</p>\n<p>CoT로는 few-shots에 없는 더 어려운 problem을 풀기 어려운 문제점이 있는데, 그 문제를 해결하기 위해 더 어려운 문제를 few-shots에 존재하는 problem으로 더 쪼개버리는 것이다.</p>\n<p>마치 복잡한 signal을 sin, cos으로 linear decomposition을 하듯이, 어려운 문제를 몇가지 subquestion으로 쪼개고 sequentially 문제를 해결한다.</p>\n<h2 id=\"-marginal-probability-vs-conditional-probability\" style=\"position:relative;\"><a href=\"#-marginal-probability-vs-conditional-probability\" aria-label=\" marginal probability vs conditional probability permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>📌 Marginal probability vs Conditional probability</h2>\n<p>여기까지 생각을 해봤을 때, 나의 관점에서는 CoT에 더이상 큰 결함이 없어 보였다.</p>\n<p>그러나, 이 가설을 듣고 아직 한참 멀었다는 생각을 했는데</p>\n<p>기본적으로 바로 우리가 구하고 싶은 것은 Marginal probability = P(Answer | Problem)이지, Conditional probability = P(Intermediate step, Answer | Problem) 이 아니라는 것이다. 따라서 Marginal probability를 구할 수 있는 다양한 가설에 대한 연구가 진행되었다.</p>\n<p>다음 포스팅에서 이에 대해 알아보자</p>\n<h2 id=\"-reference\" style=\"position:relative;\"><a href=\"#-reference\" aria-label=\" reference permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🗂 <em>Reference</em></h2>\n<p>[1] <em><a href=\"https://arxiv.org/pdf/2201.11903\">https://arxiv.org/pdf/2201.11903</a></em></p>\n<p>[2] <em><a href=\"https://dennyzhou.github.io/LLM-Reasoning-Berkeley.pdf\">https://dennyzhou.github.io/LLM-Reasoning-Berkeley.pdf</a></em></p>\n<p>[3] <em><a href=\"https://aclanthology.org/P17-1015.pdf\">https://aclanthology.org/P17-1015.pdf</a></em></p>\n<p>[4] <em><a href=\"https://openreview.net/pdf?id=3EWTEy9MTM\">https://openreview.net/pdf?id=3EWTEy9MTM</a></em></p>\n<p>[5] <em><a href=\"https://arxiv.org/pdf/2205.10625\">https://arxiv.org/pdf/2205.10625</a></em></p>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#-%EC%9D%98%EC%99%B8%EB%A1%9C-%EC%9E%98-%EB%AA%A8%EB%A5%B4%EB%8A%94-cot\">🤔 의외로 잘 모르는 CoT</a></li>\n<li><a href=\"#-prompt-%EA%B8%B0%EB%B0%98-intermediate-steps-rationale\">📌 Prompt 기반 Intermediate steps (rationale)</a></li>\n<li><a href=\"#-intermediate-stepcot%EC%9D%B4-llm%EC%97%90-%EB%AF%B8%EC%B9%98%EB%8A%94-%EC%98%81%ED%96%A5\">📌 Intermediate step(CoT)이 LLM에 미치는 영향</a></li>\n<li><a href=\"#-cot%EC%9D%98-robustness\">📌 CoT의 robustness</a></li>\n<li><a href=\"#-marginal-probability-vs-conditional-probability\">📌 Marginal probability vs Conditional probability</a></li>\n<li><a href=\"#-reference\">🗂 <em>Reference</em></a></li>\n</ul>\n</div>","excerpt":"AI should be able to learn from just a few examples, like what humans usually do - Denny Zhou - 🤔 의외로 잘 모르는 CoT NLP 연구를 하면서 Chain-of-Thought (CoT) [1] 를 듣지 않기란 쉽지 않다. 그러나, 생각해보니 얕은 깊이의 개념 정도만 인지하고 있을뿐 CoT에 대해 깊이 생각해본적이 없고, 심지어 CoT 논문도 제대로 읽어본적도 없다…!! 이번 기회에 CoT 뿐만 아니라, 이후 후속연구도 보면서 CoT가 가지고 있는 insight을 파헤쳐 보려한다. 이번 글은 특히 “LLM Reasoning: Key Ideas and Limitations” [2] 글에 큰 영향을 받았다. 📌 Prompt 기반 Intermediate steps (rationale) CoT 논문을 보다보면 Intermediate steps이라는 용어가 자주 등장한다. Intermediate steps이란 정답을…","frontmatter":{"date":"November 13, 2024","title":"CoT에 대한 고찰","categories":"consideration","author":"진명","emoji":"✍️"},"fields":{"slug":"/consideration-CoT/"}},"next":{"id":"7324034c-3720-5363-af12-22f50e0e9bc4","html":"","frontmatter":{"date":"July 08, 2024","title":"오늘의 회사 - Antropic","categories":"business","author":"진명","emoji":"🧤"},"fields":{"slug":"/today-company-Antropic/"}},"prev":null,"site":{"siteMetadata":{"siteUrl":"https://jinmyeongan.github.io","comments":{"utterances":{"repo":"jinmyeongAN/jinmyeongAN.github.io"}}}}},"pageContext":{"slug":"/consideration-CoT/","nextSlug":"/today-company-Antropic/","prevSlug":""}},"staticQueryHashes":["1073350324","1956554647","2938748437"]}